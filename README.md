# RawNet2 for Voice AntiSpoofing

ДЗ-5 на курсе DLA 2023/24.

## Preliminaries

Предварительно необходимо установить используемые зависимости путём вызова команды
```commandline
pip install -r requirements.txt
```

Код проверялся на Python 3.10

## Обучение

### Датасет

Для обучения используется часть Logical Access датасета [ASVSpoof 2019 Dataset](https://datashare.ed.ac.uk/handle/10283/3336) ([Kaggle](https://www.kaggle.com/datasets/awsaf49/asvpoof-2019-dataset)).
В файле конфига в качестве аргумента датасета `data_dir` можно указать директорию, в которой хранится датасет.
Указанная директория должна иметь следующий вид:
```
dir
|- LA
|  |- ASVspoof2019_LA_dev
|  |- ASVspoof2019_LA_eval
|  |- ASVspoof2019_LA_train
|  |- ASVspoof2019_LA_cm_protocols
```
В случае отсутствия файлов датасета в директории `data_dir` (по умолчанию: `data/datasets/ASVSpoof2019`)
файлы будут загружены автоматически.

В качестве аргумента `index_dir` датасета в конфиге следует указать директорию с правами на запись, в
которую будет сохранён индекс (некоторые служебные данные) для датасета (по умолчанию значение
совпадает с `data_dir`).

### Запуск обучения

Для обучения модели достаточно выбрать конфиг из `configs` или задать свой по аналогии, а
затем запустить команду
```commandline
python3 train.py \
   --config={путь до файла конфига}
```

Для продолжения обучения чекпоинта можно использовать аргумент `-r/--resume`:
```commandline
python3 train.py \
   --config={путь до файла конфига} \
   --resume={путь до сохранённого чекпоинта}
```

> Периодичность и директорию сохранения чекпоинтов моделей можно указать в конфиге обучения.
> Также реализованы импорт/экспорт на Google Диск.

## Inference

Для того, чтобы запустить обученную модель на произвольных аудио, достаточно вызвать скрипт
```commandline
python3 test.py
```

> Модель обучалась с использованием конфига `configs/kaggle/ablation/hint1/baseline_sinc-no-abs.json` в течение 46 эпох.

В таком виде будет загружена обученная модель.
Затем она будет запущена на аудио из директории `demo_audios`.
В консоль для каждого аудио будет выведена предсказанная вероятность того, что оно является настоящим (не сгенерированным).

Также в скрипт можно передать аргументы:
- `-i/--input`: путь до директории с аудиофайлами (по умолчанию - `demo_audios`)
- `-c/--checkpoint`: путь до чекпоинта модели

Ноутбук с примером inference-а модели - [тык](https://colab.research.google.com/drive/1EYM6eA9EOkcGmesuwMTsy8zCEUue45ty?usp=sharing).


## Автор

Егоров Егор:
- tg: [@TrickmanOff](https://t.me/TrickmanOff)
- e-mail: yegyegorov@gmail.com
